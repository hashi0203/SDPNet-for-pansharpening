WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
source_pan_data shape: (1296, 264, 264, 1)
gt_data shape: (1296, 264, 264, 4)
data shape: (1296, 264, 264, 5)
Epoches: 30, Batch_size: 8
Train images number 1296, Batches: 162.

2021-12-09 03:21:12.308188: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-09 03:21:14.015488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38414 MB memory:  -> device: 0, name: A100-PCIE-40GB, pci bus id: 0000:81:00.0, compute capability: 8.0
2021-12-09 03:21:14.017384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38414 MB memory:  -> device: 1, name: A100-PCIE-40GB, pci bus id: 0000:82:00.0, compute capability: 8.0
2021-12-09 03:21:14.019172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38414 MB memory:  -> device: 2, name: A100-PCIE-40GB, pci bus id: 0000:c1:00.0, compute capability: 8.0
2021-12-09 03:21:14.020947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38414 MB memory:  -> device: 3, name: A100-PCIE-40GB, pci bus id: 0000:c2:00.0, compute capability: 8.0
out shape: (8, 264, 264, 1)
MS_converted_PAN shape: (8, 264, 264, 1)
<tf.Variable 'pP_ED/encoder/conv1/kernel:0' shape=(3, 3, 4, 32) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv1/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv2/kernel:0' shape=(3, 3, 32, 64) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv2/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv3/kernel:0' shape=(3, 3, 64, 96) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv3/bias:0' shape=(96,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_1/kernel:0' shape=(3, 3, 96, 64) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_1/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_2/kernel:0' shape=(3, 3, 64, 32) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_2/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_3/kernel:0' shape=(3, 3, 32, 1) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_3/bias:0' shape=(1,) dtype=float32_ref>
2021-12-09 03:21:17.207208: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8301
Epoch:1/30: step:100, lr:0.0017426455, loss:0.18770483, pPAN_max:0.76073813, pPAN_min:0.030683696, elapsed_time:0:00:28.781541

Epoch:2/30: step:200, lr:0.0015184064, loss:0.0457148, pPAN_max:0.8145509, pPAN_min:0.03561908, elapsed_time:0:00:51.471222

Epoch:2/30: step:300, lr:0.001323022, loss:0.021004537, pPAN_max:0.83800375, pPAN_min:0.036862314, elapsed_time:0:01:13.320107

Epoch:3/30: step:400, lr:0.0011527791, loss:0.015990734, pPAN_max:0.8436651, pPAN_min:0.035177708, elapsed_time:0:01:35.718561

Epoch:4/30: step:500, lr:0.0010044425, loss:0.014105338, pPAN_max:0.8380581, pPAN_min:0.033958733, elapsed_time:0:01:58.160243

Epoch:4/30: step:600, lr:0.00087519345, loss:0.013715525, pPAN_max:0.83777213, pPAN_min:0.032850415, elapsed_time:0:02:20.705971

Epoch:5/30: step:700, lr:0.00076257583, loss:0.013196025, pPAN_max:0.84284806, pPAN_min:0.032436132, elapsed_time:0:02:43.704943

Epoch:5/30: step:800, lr:0.00066444965, loss:0.012861574, pPAN_max:0.84077626, pPAN_min:0.031834602, elapsed_time:0:03:06.179405

Epoch:6/30: step:900, lr:0.00057895004, loss:0.012796536, pPAN_max:0.8408522, pPAN_min:0.031535685, elapsed_time:0:03:29.228373

Epoch:7/30: step:1000, lr:0.0005044523, loss:0.012565092, pPAN_max:0.8405367, pPAN_min:0.0312092, elapsed_time:0:03:52.176063

Epoch:7/30: step:1100, lr:0.00043954072, loss:0.012628965, pPAN_max:0.8422567, pPAN_min:0.031095415, elapsed_time:0:04:14.419685

Epoch:8/30: step:1200, lr:0.00038298176, loss:0.012226853, pPAN_max:0.8422049, pPAN_min:0.030848414, elapsed_time:0:04:37.444727

Epoch:9/30: step:1300, lr:0.00033370068, loss:0.012366474, pPAN_max:0.84255123, pPAN_min:0.030701727, elapsed_time:0:05:00.370815

Epoch:9/30: step:1400, lr:0.00029076095, loss:0.012200963, pPAN_max:0.8425632, pPAN_min:0.030557245, elapsed_time:0:05:22.840603

Epoch:10/30: step:1500, lr:0.0002533466, loss:0.012060599, pPAN_max:0.8431333, pPAN_min:0.030420244, elapsed_time:0:05:45.827715

Epoch:10/30: step:1600, lr:0.00022074668, loss:0.012079437, pPAN_max:0.8434195, pPAN_min:0.030338287, elapsed_time:0:06:08.020072

Epoch:11/30: step:1700, lr:0.00019234157, loss:0.012179375, pPAN_max:0.8435877, pPAN_min:0.030233473, elapsed_time:0:06:30.586656

Epoch:12/30: step:1800, lr:0.00016759156, loss:0.011959263, pPAN_max:0.84365916, pPAN_min:0.02998814, elapsed_time:0:06:53.774039

Epoch:12/30: step:1900, lr:0.0001460263, loss:0.01191104, pPAN_max:0.84380394, pPAN_min:0.030098528, elapsed_time:0:07:16.247165

Epoch:13/30: step:2000, lr:0.00012723604, loss:0.011939318, pPAN_max:0.8437464, pPAN_min:0.030029953, elapsed_time:0:07:39.230414

Epoch:13/30: step:2100, lr:0.00011086366, loss:0.011967696, pPAN_max:0.8439969, pPAN_min:0.029998273, elapsed_time:0:08:01.692524

Epoch:14/30: step:2200, lr:9.6598014e-05, loss:0.011945405, pPAN_max:0.8438831, pPAN_min:0.029647708, elapsed_time:0:08:24.880082

Epoch:15/30: step:2300, lr:8.416805e-05, loss:0.011862959, pPAN_max:0.8438773, pPAN_min:0.029934615, elapsed_time:0:08:47.735973

Epoch:15/30: step:2400, lr:7.333752e-05, loss:0.011797603, pPAN_max:0.84396553, pPAN_min:0.029890984, elapsed_time:0:09:10.112506

Epoch:16/30: step:2500, lr:6.390065e-05, loss:0.011825495, pPAN_max:0.84396267, pPAN_min:0.02942273, elapsed_time:0:09:32.975941

Epoch:17/30: step:2600, lr:5.567807e-05, loss:0.011658862, pPAN_max:0.8443198, pPAN_min:0.029832482, elapsed_time:0:09:56.740515

Epoch:17/30: step:2700, lr:4.851358e-05, loss:0.0117739085, pPAN_max:0.8446033, pPAN_min:0.02980411, elapsed_time:0:10:19.019700

Epoch:18/30: step:2800, lr:4.2270967e-05, loss:0.011740554, pPAN_max:0.8443863, pPAN_min:0.029794425, elapsed_time:0:10:41.620364

Epoch:18/30: step:2900, lr:3.6831654e-05, loss:0.011864023, pPAN_max:0.8444959, pPAN_min:0.029760778, elapsed_time:0:11:03.651963

Epoch:19/30: step:3000, lr:3.209225e-05, loss:0.011723975, pPAN_max:0.8446545, pPAN_min:0.029750764, elapsed_time:0:11:26.301312

Epoch:20/30: step:3100, lr:2.7962698e-05, loss:0.0115132835, pPAN_max:0.8445153, pPAN_min:0.029182076, elapsed_time:0:11:48.896407

Epoch:20/30: step:3200, lr:2.4364546e-05, loss:0.011749184, pPAN_max:0.8445995, pPAN_min:0.029172122, elapsed_time:0:12:11.404342

Epoch:21/30: step:3300, lr:2.1229376e-05, loss:0.011669211, pPAN_max:0.84452987, pPAN_min:0.0296897, elapsed_time:0:12:34.430107

Epoch:21/30: step:3400, lr:1.8497638e-05, loss:0.011692161, pPAN_max:0.84451294, pPAN_min:0.029557168, elapsed_time:0:12:57.630028

Epoch:22/30: step:3500, lr:1.6117414e-05, loss:0.011673535, pPAN_max:0.84464693, pPAN_min:0.029699683, elapsed_time:0:13:20.740774

Epoch:23/30: step:3600, lr:1.4043463e-05, loss:0.01164499, pPAN_max:0.84444606, pPAN_min:0.029668719, elapsed_time:0:13:43.656814

Epoch:23/30: step:3700, lr:1.2236388e-05, loss:0.01148572, pPAN_max:0.8446606, pPAN_min:0.02907145, elapsed_time:0:14:06.125700

Epoch:24/30: step:3800, lr:1.066184e-05, loss:0.011669157, pPAN_max:0.8446129, pPAN_min:0.029649287, elapsed_time:0:14:29.134721

Epoch:25/30: step:3900, lr:9.289908e-06, loss:0.011654843, pPAN_max:0.84487975, pPAN_min:0.02902463, elapsed_time:0:14:52.137015

Epoch:25/30: step:4000, lr:8.094505e-06, loss:0.011724429, pPAN_max:0.84468794, pPAN_min:0.0290201, elapsed_time:0:15:14.533176

Epoch:26/30: step:4100, lr:7.052926e-06, loss:0.011651341, pPAN_max:0.8449069, pPAN_min:0.029612929, elapsed_time:0:15:37.708377

Epoch:26/30: step:4200, lr:6.145375e-06, loss:0.011652354, pPAN_max:0.8447033, pPAN_min:0.02898255, elapsed_time:0:16:00.217174

Epoch:27/30: step:4300, lr:5.354603e-06, loss:0.011585828, pPAN_max:0.8449302, pPAN_min:0.029574752, elapsed_time:0:16:23.223928

Epoch:28/30: step:4400, lr:4.6655878e-06, loss:0.011537829, pPAN_max:0.84477854, pPAN_min:0.029574305, elapsed_time:0:16:46.256268

Epoch:28/30: step:4500, lr:4.065231e-06, loss:0.011555477, pPAN_max:0.8450351, pPAN_min:0.029565096, elapsed_time:0:17:08.847604

Epoch:29/30: step:4600, lr:3.54213e-06, loss:0.011506047, pPAN_max:0.8449487, pPAN_min:0.028950661, elapsed_time:0:17:31.804842

Epoch:30/30: step:4700, lr:3.0863373e-06, loss:0.011653371, pPAN_max:0.8448657, pPAN_min:0.029573977, elapsed_time:0:17:54.649054

Epoch:30/30: step:4800, lr:2.6891958e-06, loss:0.011619317, pPAN_max:0.8448399, pPAN_min:0.029564112, elapsed_time:0:18:16.994647

Epoch:30/30: step:4860, lr:2.4758808e-06, loss:0.011511466, pPAN_max:0.84501034, pPAN_min:0.029574662, elapsed_time:0:18:30.481040

