WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
source_pan_data shape: (1296, 264, 264, 1)
gt_data shape: (1296, 264, 264, 4)
data shape: (1296, 264, 264, 5)
Epoches: 50, Batch_size: 8
Train images number 1296, Batches: 162.

2021-12-05 11:42:07.205344: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-05 11:42:07.690745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78874 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:27:00.0, compute capability: 8.0
out shape: (8, 264, 264, 4)
PAN_converted_MS shape: (8, 264, 264, 4)
<tf.Variable 'pMS_ED/encoder/conv1/kernel:0' shape=(3, 3, 1, 32) dtype=float32_ref>
<tf.Variable 'pMS_ED/encoder/conv1/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pMS_ED/encoder/conv2/kernel:0' shape=(3, 3, 32, 64) dtype=float32_ref>
<tf.Variable 'pMS_ED/encoder/conv2/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pMS_ED/encoder/conv3/kernel:0' shape=(3, 3, 64, 96) dtype=float32_ref>
<tf.Variable 'pMS_ED/encoder/conv3/bias:0' shape=(96,) dtype=float32_ref>
<tf.Variable 'pMS_ED_1/decoder/conv2_1/kernel:0' shape=(3, 3, 96, 64) dtype=float32_ref>
<tf.Variable 'pMS_ED_1/decoder/conv2_1/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pMS_ED_1/decoder/conv2_2/kernel:0' shape=(3, 3, 64, 32) dtype=float32_ref>
<tf.Variable 'pMS_ED_1/decoder/conv2_2/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pMS_ED_1/decoder/conv2_3/kernel:0' shape=(3, 3, 32, 4) dtype=float32_ref>
<tf.Variable 'pMS_ED_1/decoder/conv2_3/bias:0' shape=(4,) dtype=float32_ref>
2021-12-05 11:42:12.097844: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8301
Epoch:1/50: step:100, lr:0.0018740649, loss:0.20004627, pMS_max:0.91035664, pMS_min:0.021140248, elapsed_time:0:00:27.504157

Epoch:2/50: step:200, lr:0.0017560596, loss:0.15230115, pMS_max:0.9016873, pMS_min:0.022270888, elapsed_time:0:00:48.738109

Epoch:2/50: step:300, lr:0.0016454849, loss:0.13042672, pMS_max:0.914116, pMS_min:0.021677017, elapsed_time:0:01:10.137778

Epoch:3/50: step:400, lr:0.0015418726, loss:0.12481352, pMS_max:0.905599, pMS_min:0.018988192, elapsed_time:0:01:31.089664

Epoch:4/50: step:500, lr:0.0014447847, loss:0.11811502, pMS_max:0.91004777, pMS_min:0.018310964, elapsed_time:0:01:51.579395

Epoch:4/50: step:600, lr:0.0013538103, loss:0.11175361, pMS_max:0.90986407, pMS_min:0.015666038, elapsed_time:0:02:11.558929

Epoch:5/50: step:700, lr:0.001268564, loss:0.10496497, pMS_max:0.9168294, pMS_min:0.013001829, elapsed_time:0:02:32.106379

Epoch:5/50: step:800, lr:0.0011886858, loss:0.102564186, pMS_max:0.9077825, pMS_min:0.013163716, elapsed_time:0:02:52.043224

Epoch:6/50: step:900, lr:0.0011138369, loss:0.09778285, pMS_max:0.9268074, pMS_min:0.012317091, elapsed_time:0:03:12.546661

Epoch:7/50: step:1000, lr:0.0010437015, loss:0.09430203, pMS_max:0.9252299, pMS_min:0.014881164, elapsed_time:0:03:33.224414

Epoch:7/50: step:1100, lr:0.0009779821, loss:0.09269985, pMS_max:0.92800236, pMS_min:0.014005244, elapsed_time:0:03:53.361706

Epoch:8/50: step:1200, lr:0.00091640104, loss:0.09019505, pMS_max:0.92797923, pMS_min:0.016083807, elapsed_time:0:04:14.037829

Epoch:9/50: step:1300, lr:0.00085869746, loss:0.08685829, pMS_max:0.93119836, pMS_min:0.016064584, elapsed_time:0:04:34.517736

Epoch:9/50: step:1400, lr:0.0008046273, loss:0.08669834, pMS_max:0.92773557, pMS_min:0.016131312, elapsed_time:0:04:54.255590

Epoch:10/50: step:1500, lr:0.000753962, loss:0.08444607, pMS_max:0.9288556, pMS_min:0.015461236, elapsed_time:0:05:16.328950

Epoch:10/50: step:1600, lr:0.00070648687, loss:0.08148514, pMS_max:0.9304286, pMS_min:0.01678139, elapsed_time:0:05:36.081044

Epoch:11/50: step:1700, lr:0.000662001, loss:0.08088263, pMS_max:0.92910504, pMS_min:0.016723633, elapsed_time:0:05:56.755523

Epoch:12/50: step:1800, lr:0.0006203165, loss:0.07912572, pMS_max:0.9325676, pMS_min:0.015644014, elapsed_time:0:06:17.342289

Epoch:12/50: step:1900, lr:0.0005812566, loss:0.08040801, pMS_max:0.93003964, pMS_min:0.016670227, elapsed_time:0:06:37.132167

Epoch:13/50: step:2000, lr:0.0005446563, loss:0.07772202, pMS_max:0.9308238, pMS_min:0.014255524, elapsed_time:0:06:57.853614

Epoch:13/50: step:2100, lr:0.00051036075, loss:0.074559495, pMS_max:0.93457556, pMS_min:0.014524519, elapsed_time:0:07:17.418016

Epoch:14/50: step:2200, lr:0.0004782245, loss:0.072581366, pMS_max:0.93460745, pMS_min:0.014828473, elapsed_time:0:07:37.799185

Epoch:15/50: step:2300, lr:0.0004481119, loss:0.07156709, pMS_max:0.9333485, pMS_min:0.013400018, elapsed_time:0:07:58.123920

Epoch:15/50: step:2400, lr:0.00041989537, loss:0.07307869, pMS_max:0.93211, pMS_min:0.012547195, elapsed_time:0:08:19.511024

Epoch:16/50: step:2500, lr:0.00039345556, loss:0.0687271, pMS_max:0.9352262, pMS_min:0.012956947, elapsed_time:0:08:40.008859

Epoch:17/50: step:2600, lr:0.00036868063, loss:0.06891276, pMS_max:0.9332199, pMS_min:0.011580437, elapsed_time:0:09:00.473908

Epoch:17/50: step:2700, lr:0.00034546576, loss:0.06810737, pMS_max:0.935276, pMS_min:0.0114304125, elapsed_time:0:09:19.970864

Epoch:18/50: step:2800, lr:0.00032371256, loss:0.06668537, pMS_max:0.93318194, pMS_min:0.012190461, elapsed_time:0:09:40.485075

Epoch:18/50: step:2900, lr:0.0003033292, loss:0.0644131, pMS_max:0.9330268, pMS_min:0.011946768, elapsed_time:0:10:00.349430

Epoch:19/50: step:3000, lr:0.00028422935, loss:0.06601831, pMS_max:0.9318707, pMS_min:0.01180464, elapsed_time:0:10:20.683422

Epoch:20/50: step:3100, lr:0.00026633203, loss:0.06427048, pMS_max:0.9334595, pMS_min:0.010855079, elapsed_time:0:10:41.117646

Epoch:20/50: step:3200, lr:0.0002495618, loss:0.0627768, pMS_max:0.9322818, pMS_min:0.0107423365, elapsed_time:0:11:01.110145

Epoch:21/50: step:3300, lr:0.00023384747, loss:0.061317187, pMS_max:0.9332987, pMS_min:0.010399342, elapsed_time:0:11:21.530064

Epoch:21/50: step:3400, lr:0.00021912271, loss:0.062169984, pMS_max:0.9328485, pMS_min:0.009955645, elapsed_time:0:11:41.306843

Epoch:22/50: step:3500, lr:0.00020532508, loss:0.060657334, pMS_max:0.931955, pMS_min:0.010042369, elapsed_time:0:12:02.679442

Epoch:23/50: step:3600, lr:0.00019239623, loss:0.06045785, pMS_max:0.9331633, pMS_min:0.009942204, elapsed_time:0:12:24.465023

Epoch:23/50: step:3700, lr:0.00018028154, loss:0.0596447, pMS_max:0.9342271, pMS_min:0.00955075, elapsed_time:0:12:43.961953

Epoch:24/50: step:3800, lr:0.00016892965, loss:0.059567068, pMS_max:0.93454397, pMS_min:0.009731591, elapsed_time:0:13:04.404028

Epoch:25/50: step:3900, lr:0.00015829258, loss:0.05800189, pMS_max:0.93425107, pMS_min:0.009762526, elapsed_time:0:13:24.673137

Epoch:25/50: step:4000, lr:0.00014832527, loss:0.057359774, pMS_max:0.93341506, pMS_min:0.009675771, elapsed_time:0:13:44.229723

Epoch:26/50: step:4100, lr:0.00013898559, loss:0.057961497, pMS_max:0.9340897, pMS_min:0.009922236, elapsed_time:0:14:04.441017

Epoch:26/50: step:4200, lr:0.00013023401, loss:0.05721701, pMS_max:0.9340788, pMS_min:0.009352326, elapsed_time:0:14:24.092038

Epoch:27/50: step:4300, lr:0.00012203348, loss:0.05464298, pMS_max:0.93388426, pMS_min:0.009357154, elapsed_time:0:14:44.297592

Epoch:28/50: step:4400, lr:0.00011434935, loss:0.055365317, pMS_max:0.933601, pMS_min:0.010017037, elapsed_time:0:15:04.662757

Epoch:28/50: step:4500, lr:0.00010714903, loss:0.056012973, pMS_max:0.93279696, pMS_min:0.009508014, elapsed_time:0:15:24.523634

Epoch:29/50: step:4600, lr:0.00010040214, loss:0.05602546, pMS_max:0.9345156, pMS_min:0.009416014, elapsed_time:0:15:44.633994

Epoch:30/50: step:4700, lr:9.408005e-05, loss:0.053943083, pMS_max:0.93467855, pMS_min:0.009488106, elapsed_time:0:16:04.934616

Epoch:30/50: step:4800, lr:8.815607e-05, loss:0.05456394, pMS_max:0.9341575, pMS_min:0.009401053, elapsed_time:0:16:24.798989

Epoch:31/50: step:4900, lr:8.2605075e-05, loss:0.055318657, pMS_max:0.9339365, pMS_min:0.009752065, elapsed_time:0:16:44.917089

Epoch:31/50: step:5000, lr:7.740363e-05, loss:0.052164204, pMS_max:0.9350814, pMS_min:0.009668589, elapsed_time:0:17:04.199829

Epoch:32/50: step:5100, lr:7.252972e-05, loss:0.05398488, pMS_max:0.9341436, pMS_min:0.009447217, elapsed_time:0:17:25.871050

Epoch:33/50: step:5200, lr:6.7962705e-05, loss:0.052758366, pMS_max:0.93455696, pMS_min:0.009373397, elapsed_time:0:17:46.006990

Epoch:33/50: step:5300, lr:6.368327e-05, loss:0.05223482, pMS_max:0.9344599, pMS_min:0.009262949, elapsed_time:0:18:05.603511

Epoch:34/50: step:5400, lr:5.967329e-05, loss:0.05176613, pMS_max:0.93523705, pMS_min:0.0093895495, elapsed_time:0:18:25.739797

Epoch:34/50: step:5500, lr:5.5915792e-05, loss:0.051466767, pMS_max:0.93536675, pMS_min:0.009434372, elapsed_time:0:18:45.241301

Epoch:35/50: step:5600, lr:5.239492e-05, loss:0.050735507, pMS_max:0.9344514, pMS_min:0.0092969835, elapsed_time:0:19:05.974935

Epoch:36/50: step:5700, lr:4.9095746e-05, loss:0.051327754, pMS_max:0.93524754, pMS_min:0.009392828, elapsed_time:0:19:27.324708

Epoch:36/50: step:5800, lr:4.6004294e-05, loss:0.050798617, pMS_max:0.9353708, pMS_min:0.009524047, elapsed_time:0:19:46.823763

Epoch:37/50: step:5900, lr:4.3107524e-05, loss:0.051787697, pMS_max:0.93546367, pMS_min:0.009759396, elapsed_time:0:20:07.046475

Epoch:38/50: step:6000, lr:4.039315e-05, loss:0.050957758, pMS_max:0.9355056, pMS_min:0.0093081, elapsed_time:0:20:29.639900

Epoch:38/50: step:6100, lr:3.7849695e-05, loss:0.04936434, pMS_max:0.9353234, pMS_min:0.009301037, elapsed_time:0:20:49.064640

Epoch:39/50: step:6200, lr:3.546638e-05, loss:0.05126211, pMS_max:0.93541145, pMS_min:0.009413153, elapsed_time:0:21:09.404091

Epoch:39/50: step:6300, lr:3.323315e-05, loss:0.04971952, pMS_max:0.9349648, pMS_min:0.009483129, elapsed_time:0:21:29.036132

Epoch:40/50: step:6400, lr:3.1140542e-05, loss:0.048835892, pMS_max:0.9359266, pMS_min:0.009387463, elapsed_time:0:21:49.215210

Epoch:41/50: step:6500, lr:2.9179691e-05, loss:0.050534952, pMS_max:0.9354766, pMS_min:0.009608924, elapsed_time:0:22:12.674427

Epoch:41/50: step:6600, lr:2.7342321e-05, loss:0.050086126, pMS_max:0.9353221, pMS_min:0.009423047, elapsed_time:0:22:32.355124

Epoch:42/50: step:6700, lr:2.5620644e-05, loss:0.04850301, pMS_max:0.9355149, pMS_min:0.009359449, elapsed_time:0:22:52.536263

Epoch:42/50: step:6800, lr:2.4007377e-05, loss:0.049249753, pMS_max:0.9356206, pMS_min:0.009601176, elapsed_time:0:23:12.554490

Epoch:43/50: step:6900, lr:2.2495688e-05, loss:0.049153693, pMS_max:0.93574476, pMS_min:0.009544253, elapsed_time:0:23:32.674938

Epoch:44/50: step:7000, lr:2.107919e-05, loss:0.049586434, pMS_max:0.9362745, pMS_min:0.009542525, elapsed_time:0:23:52.690987

Epoch:44/50: step:7100, lr:1.9751888e-05, loss:0.050147053, pMS_max:0.9356534, pMS_min:0.009700835, elapsed_time:0:24:12.155316

Epoch:45/50: step:7200, lr:1.8508155e-05, loss:0.04858447, pMS_max:0.936039, pMS_min:0.009502798, elapsed_time:0:24:32.665251

Epoch:46/50: step:7300, lr:1.7342743e-05, loss:0.0488232, pMS_max:0.935719, pMS_min:0.009587079, elapsed_time:0:24:52.800845

Epoch:46/50: step:7400, lr:1.6250715e-05, loss:0.048008744, pMS_max:0.9357911, pMS_min:0.009633511, elapsed_time:0:25:12.527548

Epoch:47/50: step:7500, lr:1.5227448e-05, loss:0.04785245, pMS_max:0.9360255, pMS_min:0.009450942, elapsed_time:0:25:32.728315

Epoch:47/50: step:7600, lr:1.4268611e-05, loss:0.04887507, pMS_max:0.93591315, pMS_min:0.009678066, elapsed_time:0:25:52.156557

Epoch:48/50: step:7700, lr:1.3370153e-05, loss:0.046721965, pMS_max:0.93580157, pMS_min:0.009528846, elapsed_time:0:26:12.368032

Epoch:49/50: step:7800, lr:1.25282695e-05, loss:0.047726758, pMS_max:0.9360998, pMS_min:0.009577841, elapsed_time:0:26:32.480590

Epoch:49/50: step:7900, lr:1.1739391e-05, loss:0.048205726, pMS_max:0.93613946, pMS_min:0.00948751, elapsed_time:0:26:52.443441

Epoch:50/50: step:8000, lr:1.1000192e-05, loss:0.0497905, pMS_max:0.93602073, pMS_min:0.009618133, elapsed_time:0:27:12.947061

Epoch:50/50: step:8100, lr:1.0307538e-05, loss:0.047356617, pMS_max:0.93618464, pMS_min:0.009595662, elapsed_time:0:27:32.910361

