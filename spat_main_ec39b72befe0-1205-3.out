WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
source_pan_data shape: (1296, 264, 264, 1)
gt_data shape: (1296, 264, 264, 4)
data shape: (1296, 264, 264, 5)
Epoches: 30, Batch_size: 10
Train images number 1296, Batches: 129.

Train set has been trimmed 6 samples...

2021-12-05 09:35:52.721217: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-05 09:35:54.397114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38414 MB memory:  -> device: 0, name: A100-PCIE-40GB, pci bus id: 0000:81:00.0, compute capability: 8.0
2021-12-05 09:35:54.399031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38414 MB memory:  -> device: 1, name: A100-PCIE-40GB, pci bus id: 0000:82:00.0, compute capability: 8.0
2021-12-05 09:35:54.400797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38414 MB memory:  -> device: 2, name: A100-PCIE-40GB, pci bus id: 0000:c1:00.0, compute capability: 8.0
2021-12-05 09:35:54.402596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38414 MB memory:  -> device: 3, name: A100-PCIE-40GB, pci bus id: 0000:c2:00.0, compute capability: 8.0
out shape: (10, 264, 264, 1)
2021-12-05 09:35:56.597383: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8301
Epoch:1/30: step:100, lr:0.0017632586, loss:0.015784163, elapsed_time:0:00:18.599992

Epoch:2/30: step:200, lr:0.0015545404, loss:0.0013533996, elapsed_time:0:00:29.459854

Epoch:3/30: step:300, lr:0.0013705282, loss:0.0008046142, elapsed_time:0:00:40.259114

Epoch:4/30: step:400, lr:0.0012082979, loss:0.0006223062, elapsed_time:0:00:51.058952

Epoch:4/30: step:500, lr:0.0010652709, loss:0.00054949464, elapsed_time:0:01:01.283662

Epoch:5/30: step:600, lr:0.0009391739, loss:0.00050954695, elapsed_time:0:01:12.213469

Epoch:6/30: step:700, lr:0.00082800316, loss:0.00046195928, elapsed_time:0:01:23.162521

Epoch:7/30: step:800, lr:0.0007299919, loss:0.00041622596, elapsed_time:0:01:34.067343

Epoch:7/30: step:900, lr:0.00064358214, loss:0.00037744135, elapsed_time:0:01:44.327590

Epoch:8/30: step:1000, lr:0.0005674008, loss:0.00036128875, elapsed_time:0:01:55.289567

Epoch:9/30: step:1100, lr:0.00050023716, loss:0.00036731377, elapsed_time:0:02:06.163659

Epoch:10/30: step:1200, lr:0.00044102382, loss:0.00034923456, elapsed_time:0:02:17.102908

Epoch:11/30: step:1300, lr:0.00038881946, loss:0.00032636512, elapsed_time:0:02:28.071192

Epoch:11/30: step:1400, lr:0.00034279455, loss:0.00032159316, elapsed_time:0:02:38.372813

Epoch:12/30: step:1500, lr:0.00030221776, loss:0.00032381696, elapsed_time:0:02:49.314726

Epoch:13/30: step:1600, lr:0.00026644408, loss:0.0003103689, elapsed_time:0:03:00.183119

Epoch:14/30: step:1700, lr:0.00023490489, loss:0.00030206708, elapsed_time:0:03:11.050651

Epoch:14/30: step:1800, lr:0.00020709902, loss:0.0003169159, elapsed_time:0:03:21.332656

Epoch:15/30: step:1900, lr:0.00018258454, loss:0.00030018837, elapsed_time:0:03:32.181595

Epoch:16/30: step:2000, lr:0.00016097186, loss:0.00028088212, elapsed_time:0:03:43.061064

Epoch:17/30: step:2100, lr:0.00014191751, loss:0.0002818003, elapsed_time:0:03:53.980831

Epoch:18/30: step:2200, lr:0.0001251186, loss:0.00027737417, elapsed_time:0:04:04.887177

Epoch:18/30: step:2300, lr:0.000110308225, loss:0.0002824718, elapsed_time:0:04:15.163004

Epoch:19/30: step:2400, lr:9.7250995e-05, loss:0.0002713963, elapsed_time:0:04:26.016035

Epoch:20/30: step:2500, lr:8.573932e-05, loss:0.00026445693, elapsed_time:0:04:36.989640

Epoch:21/30: step:2600, lr:7.559029e-05, loss:0.00028351665, elapsed_time:0:04:47.990474

Epoch:21/30: step:2700, lr:6.6642606e-05, loss:0.00026333565, elapsed_time:0:04:58.182113

Epoch:22/30: step:2800, lr:5.8754056e-05, loss:0.000265863, elapsed_time:0:05:08.996365

Epoch:23/30: step:2900, lr:5.179931e-05, loss:0.0002699389, elapsed_time:0:05:19.839027

Epoch:24/30: step:3000, lr:4.5667788e-05, loss:0.00025752911, elapsed_time:0:05:30.722313

Epoch:25/30: step:3100, lr:4.0262054e-05, loss:0.0002595871, elapsed_time:0:05:41.669987

Epoch:25/30: step:3200, lr:3.5496214e-05, loss:0.00026074983, elapsed_time:0:05:51.941291

Epoch:26/30: step:3300, lr:3.129449e-05, loss:0.00027321157, elapsed_time:0:06:02.795704

Epoch:27/30: step:3400, lr:2.7590148e-05, loss:0.00027236334, elapsed_time:0:06:13.572117

Epoch:28/30: step:3500, lr:2.4324283e-05, loss:0.00024818367, elapsed_time:0:06:24.462127

Epoch:28/30: step:3600, lr:2.1444997e-05, loss:0.00024014545, elapsed_time:0:06:34.580599

Epoch:29/30: step:3700, lr:1.8906536e-05, loss:0.00025719043, elapsed_time:0:06:45.476292

Epoch:30/30: step:3800, lr:1.6668555e-05, loss:0.00024814476, elapsed_time:0:06:56.435894

Epoch:30/30: step:3870, lr:1.526153e-05, loss:0.00025567116, elapsed_time:0:07:03.596332

