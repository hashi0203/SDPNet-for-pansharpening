WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
source_pan_data shape: (4914, 264, 264, 1)
gt_data shape: (4914, 264, 264, 4)
data shape: (4914, 264, 264, 5)
Epoches: 16, Batch_size: 8
Train images number 4914, Batches: 614.

Train set has been trimmed 2 samples...

2021-12-05 01:54:29.164707: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-05 01:54:30.855494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38414 MB memory:  -> device: 0, name: A100-PCIE-40GB, pci bus id: 0000:81:00.0, compute capability: 8.0
2021-12-05 01:54:30.857373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38414 MB memory:  -> device: 1, name: A100-PCIE-40GB, pci bus id: 0000:82:00.0, compute capability: 8.0
2021-12-05 01:54:30.859164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38414 MB memory:  -> device: 2, name: A100-PCIE-40GB, pci bus id: 0000:c1:00.0, compute capability: 8.0
2021-12-05 01:54:30.860918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38414 MB memory:  -> device: 3, name: A100-PCIE-40GB, pci bus id: 0000:c2:00.0, compute capability: 8.0
out shape: (8, 264, 264, 1)
MS_converted_PAN shape: (8, 264, 264, 1)
<tf.Variable 'pP_ED/encoder/conv1/kernel:0' shape=(3, 3, 4, 32) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv1/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv2/kernel:0' shape=(3, 3, 32, 64) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv2/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv3/kernel:0' shape=(3, 3, 64, 96) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv3/bias:0' shape=(96,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_1/kernel:0' shape=(3, 3, 96, 64) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_1/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_2/kernel:0' shape=(3, 3, 64, 32) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_2/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_3/kernel:0' shape=(3, 3, 32, 1) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_3/bias:0' shape=(1,) dtype=float32_ref>
2021-12-05 01:54:35.535753: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8301
Epoch:1/16: step:100, lr:0.0019286198, loss:0.08701093, pPAN_max:0.82174104, pPAN_min:0.019172221, elapsed_time:0:00:35.923498

Epoch:1/16: step:200, lr:0.0018597872, loss:0.08319902, pPAN_max:0.9042008, pPAN_min:0.13592029, elapsed_time:0:01:04.254146

Epoch:1/16: step:300, lr:0.0017934111, loss:0.043763544, pPAN_max:0.7971972, pPAN_min:0.056425333, elapsed_time:0:01:32.508395

Epoch:1/16: step:400, lr:0.0017294041, loss:0.033597507, pPAN_max:0.8832071, pPAN_min:0.17023194, elapsed_time:0:02:01.024495

Epoch:1/16: step:500, lr:0.0016676813, loss:0.050927743, pPAN_max:0.7252698, pPAN_min:0.0016664565, elapsed_time:0:02:29.345038

WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/training/saver.py:1056: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
Epoch:1/16: step:600, lr:0.0016081616, loss:0.02538115, pPAN_max:0.7581062, pPAN_min:0.001326263, elapsed_time:0:02:57.810034

Epoch:2/16: step:700, lr:0.001550766, loss:0.031936698, pPAN_max:0.9180051, pPAN_min:0.14808124, elapsed_time:0:03:28.223863

Epoch:2/16: step:800, lr:0.0014954191, loss:0.022336097, pPAN_max:0.75819296, pPAN_min:0.13023141, elapsed_time:0:03:56.637810

Epoch:2/16: step:900, lr:0.0014420473, loss:0.087748155, pPAN_max:0.8353969, pPAN_min:0.041340232, elapsed_time:0:04:25.012984

Epoch:2/16: step:1000, lr:0.0013905803, loss:0.02933421, pPAN_max:0.68438053, pPAN_min:0.1073699, elapsed_time:0:04:53.357492

Epoch:2/16: step:1100, lr:0.0013409505, loss:0.021673163, pPAN_max:0.7871187, pPAN_min:0.00040864944, elapsed_time:0:05:21.870554

Epoch:2/16: step:1200, lr:0.0012930918, loss:0.035387512, pPAN_max:0.83508563, pPAN_min:0.09845865, elapsed_time:0:05:50.278088

Epoch:3/16: step:1300, lr:0.0012469412, loss:0.025329653, pPAN_max:0.79185677, pPAN_min:0.14684922, elapsed_time:0:06:20.718913

Epoch:3/16: step:1400, lr:0.0012024377, loss:0.028591648, pPAN_max:0.6510544, pPAN_min:0.1738371, elapsed_time:0:06:48.970221

Epoch:3/16: step:1500, lr:0.0011595224, loss:0.02764923, pPAN_max:0.6378516, pPAN_min:0.0003530383, elapsed_time:0:07:17.543479

Epoch:3/16: step:1600, lr:0.001118139, loss:0.026751598, pPAN_max:0.76656073, pPAN_min:0.0979512, elapsed_time:0:07:45.789524

Epoch:3/16: step:1700, lr:0.0010782324, loss:0.024079587, pPAN_max:0.93728006, pPAN_min:0.00022995472, elapsed_time:0:08:14.118602

Epoch:3/16: step:1800, lr:0.0010397503, loss:0.026883904, pPAN_max:0.74021965, pPAN_min:0.0003244877, elapsed_time:0:08:42.366469

Epoch:4/16: step:1900, lr:0.0010026414, loss:0.039713576, pPAN_max:0.9018439, pPAN_min:0.14522341, elapsed_time:0:09:12.780531

Epoch:4/16: step:2000, lr:0.000966857, loss:0.02239724, pPAN_max:0.6766104, pPAN_min:0.1272909, elapsed_time:0:09:40.996804

Epoch:4/16: step:2100, lr:0.00093234977, loss:0.048259936, pPAN_max:0.6904816, pPAN_min:0.00015670061, elapsed_time:0:10:09.515653

Epoch:4/16: step:2200, lr:0.00089907413, loss:0.013899453, pPAN_max:0.85746497, pPAN_min:0.10717097, elapsed_time:0:10:37.755133

Epoch:4/16: step:2300, lr:0.000866986, loss:0.0236957, pPAN_max:0.7618491, pPAN_min:0.1026395, elapsed_time:0:11:06.168643

Epoch:4/16: step:2400, lr:0.00083604315, loss:0.023534594, pPAN_max:0.74587375, pPAN_min:0.109485984, elapsed_time:0:11:34.510327

Epoch:5/16: step:2500, lr:0.0008062047, loss:0.024374064, pPAN_max:0.92992175, pPAN_min:0.09756148, elapsed_time:0:12:04.861190

Epoch:5/16: step:2600, lr:0.0007774311, loss:0.025444135, pPAN_max:0.92281735, pPAN_min:0.13918945, elapsed_time:0:12:33.424117

Epoch:5/16: step:2700, lr:0.0007496844, loss:0.023583928, pPAN_max:0.8492342, pPAN_min:0.13517472, elapsed_time:0:13:01.990540

Epoch:5/16: step:2800, lr:0.00072292815, loss:0.021971602, pPAN_max:0.80656064, pPAN_min:0.10490677, elapsed_time:0:13:30.532512

Epoch:5/16: step:2900, lr:0.00069712667, loss:0.033234708, pPAN_max:0.9099784, pPAN_min:0.10419005, elapsed_time:0:13:58.980871

Epoch:5/16: step:3000, lr:0.0006722462, loss:0.025826672, pPAN_max:0.6474608, pPAN_min:0.10580027, elapsed_time:0:14:27.511327

Epoch:6/16: step:3100, lr:0.0006482537, loss:0.021645542, pPAN_max:0.8935344, pPAN_min:0.00017622113, elapsed_time:0:14:58.216561

Epoch:6/16: step:3200, lr:0.00062511745, loss:0.018287834, pPAN_max:0.90122485, pPAN_min:0.14439401, elapsed_time:0:15:26.734784

Epoch:6/16: step:3300, lr:0.00060280686, loss:0.0305186, pPAN_max:0.74168956, pPAN_min:0.00019744039, elapsed_time:0:15:55.405553

Epoch:6/16: step:3400, lr:0.0005812926, loss:0.032784395, pPAN_max:0.68999696, pPAN_min:0.00017502904, elapsed_time:0:16:24.732517

Epoch:6/16: step:3500, lr:0.00056054624, loss:0.04046632, pPAN_max:0.88296866, pPAN_min:0.00017282367, elapsed_time:0:16:53.056721

Epoch:6/16: step:3600, lr:0.00054054026, loss:0.030998716, pPAN_max:0.91275644, pPAN_min:0.12835577, elapsed_time:0:17:21.471526

Epoch:7/16: step:3700, lr:0.0005212483, loss:0.0241397, pPAN_max:0.8270881, pPAN_min:0.060691774, elapsed_time:0:17:52.115924

Epoch:7/16: step:3800, lr:0.00050264486, loss:0.009297479, pPAN_max:0.5832969, pPAN_min:0.11995658, elapsed_time:0:18:20.588022

Epoch:7/16: step:3900, lr:0.0004847054, loss:0.020730494, pPAN_max:0.7022789, pPAN_min:0.085675895, elapsed_time:0:18:49.114805

Epoch:7/16: step:4000, lr:0.00046740618, loss:0.02095231, pPAN_max:0.7849099, pPAN_min:0.11068955, elapsed_time:0:19:17.691476

Epoch:7/16: step:4100, lr:0.00045072442, loss:0.027182538, pPAN_max:0.75901496, pPAN_min:0.00014075637, elapsed_time:0:19:46.025118

Epoch:7/16: step:4200, lr:0.000434638, loss:0.017822757, pPAN_max:0.9302762, pPAN_min:0.00017794967, elapsed_time:0:20:14.486773

Epoch:8/16: step:4300, lr:0.0004191257, loss:0.022883011, pPAN_max:0.89886695, pPAN_min:0.11424452, elapsed_time:0:20:45.037865

Epoch:8/16: step:4400, lr:0.00040416713, loss:0.020149838, pPAN_max:0.59381026, pPAN_min:0.11475828, elapsed_time:0:21:13.535904

Epoch:8/16: step:4500, lr:0.00038974232, loss:0.02059186, pPAN_max:0.60963356, pPAN_min:0.10568187, elapsed_time:0:21:42.080194

Epoch:8/16: step:4600, lr:0.00037583234, loss:0.025795491, pPAN_max:0.9437312, pPAN_min:0.09964934, elapsed_time:0:22:10.697558

Epoch:8/16: step:4700, lr:0.00036241888, loss:0.02050603, pPAN_max:0.84121823, pPAN_min:0.10505733, elapsed_time:0:22:39.326758

Epoch:8/16: step:4800, lr:0.00034948406, loss:0.015865497, pPAN_max:0.93770385, pPAN_min:0.12944266, elapsed_time:0:23:08.040717

Epoch:8/16: step:4900, lr:0.00033701095, loss:0.017230907, pPAN_max:0.9421835, pPAN_min:0.08244848, elapsed_time:0:23:36.804693

Epoch:9/16: step:5000, lr:0.00032498295, loss:0.022036312, pPAN_max:0.8590616, pPAN_min:0.06777647, elapsed_time:0:24:07.318158

Epoch:9/16: step:5100, lr:0.00031338428, loss:0.029834857, pPAN_max:0.6983237, pPAN_min:0.10741192, elapsed_time:0:24:35.843898

Epoch:9/16: step:5200, lr:0.00030219954, loss:0.010742251, pPAN_max:0.92219406, pPAN_min:0.16066092, elapsed_time:0:25:04.806297

Epoch:9/16: step:5300, lr:0.000291414, loss:0.016156614, pPAN_max:0.65346384, pPAN_min:0.0002090931, elapsed_time:0:25:33.710080

Epoch:9/16: step:5400, lr:0.00028101337, loss:0.034635015, pPAN_max:0.95433986, pPAN_min:0.00011447072, elapsed_time:0:26:02.996453

Epoch:9/16: step:5500, lr:0.00027098405, loss:0.011371305, pPAN_max:0.8577153, pPAN_min:0.11886522, elapsed_time:0:26:31.858599

Epoch:10/16: step:5600, lr:0.00026131255, loss:0.022259738, pPAN_max:0.53086674, pPAN_min:0.09781021, elapsed_time:0:27:02.496866

Epoch:10/16: step:5700, lr:0.00025198626, loss:0.019829595, pPAN_max:0.9447881, pPAN_min:0.15911546, elapsed_time:0:27:30.817018

Epoch:10/16: step:5800, lr:0.00024299283, loss:0.009790834, pPAN_max:0.80655015, pPAN_min:0.0461905, elapsed_time:0:27:59.361058

Epoch:10/16: step:5900, lr:0.00023432038, loss:0.02995089, pPAN_max:0.73771906, pPAN_min:0.00017017126, elapsed_time:0:28:28.642240

Epoch:10/16: step:6000, lr:0.00022595745, loss:0.022068722, pPAN_max:0.7224146, pPAN_min:0.09149027, elapsed_time:0:28:57.542582

Epoch:10/16: step:6100, lr:0.00021789307, loss:0.02460697, pPAN_max:0.6487049, pPAN_min:0.00019773841, elapsed_time:0:29:26.263552

Epoch:11/16: step:6200, lr:0.00021011643, loss:0.025589986, pPAN_max:0.9296889, pPAN_min:0.11754063, elapsed_time:0:29:57.269238

Epoch:11/16: step:6300, lr:0.00020261735, loss:0.020324335, pPAN_max:0.66109294, pPAN_min:0.14312965, elapsed_time:0:30:26.110296

Epoch:11/16: step:6400, lr:0.0001953859, loss:0.022888938, pPAN_max:0.6861674, pPAN_min:0.0888415, elapsed_time:0:30:55.129992

Epoch:11/16: step:6500, lr:0.00018841254, loss:0.027132148, pPAN_max:0.94094944, pPAN_min:0.1254794, elapsed_time:0:31:24.110224

Epoch:11/16: step:6600, lr:0.00018168807, loss:0.010300402, pPAN_max:0.8566779, pPAN_min:0.14023724, elapsed_time:0:31:53.010656

Epoch:11/16: step:6700, lr:0.00017520359, loss:0.020652702, pPAN_max:0.880283, pPAN_min:0.10825652, elapsed_time:0:32:22.048915

Epoch:12/16: step:6800, lr:0.00016895056, loss:0.019182952, pPAN_max:0.89416885, pPAN_min:0.09488076, elapsed_time:0:32:53.061402

Epoch:12/16: step:6900, lr:0.00016292071, loss:0.016368793, pPAN_max:0.6490295, pPAN_min:0.11474678, elapsed_time:0:33:21.962323

Epoch:12/16: step:7000, lr:0.00015710603, loss:0.01638646, pPAN_max:0.94987655, pPAN_min:0.12557113, elapsed_time:0:33:50.796788

Epoch:12/16: step:7100, lr:0.0001514989, loss:0.013970221, pPAN_max:0.93711984, pPAN_min:0.10344759, elapsed_time:0:34:19.756850

Epoch:12/16: step:7200, lr:0.00014609187, loss:0.023854306, pPAN_max:0.9428357, pPAN_min:0.12053543, elapsed_time:0:34:48.603310

Epoch:12/16: step:7300, lr:0.00014087783, loss:0.031783216, pPAN_max:0.64259744, pPAN_min:0.089292526, elapsed_time:0:35:17.679040

Epoch:13/16: step:7400, lr:0.0001358499, loss:0.029421005, pPAN_max:0.8491633, pPAN_min:0.102813214, elapsed_time:0:35:48.540434

Epoch:13/16: step:7500, lr:0.00013100139, loss:0.021967843, pPAN_max:0.6925863, pPAN_min:0.0001501143, elapsed_time:0:36:17.712882

Epoch:13/16: step:7600, lr:0.00012632593, loss:0.016090812, pPAN_max:0.73654157, pPAN_min:0.09208816, elapsed_time:0:36:46.508015

Epoch:13/16: step:7700, lr:0.000121817335, loss:0.024617597, pPAN_max:0.5642108, pPAN_min:0.00011920929, elapsed_time:0:37:15.510324

Epoch:13/16: step:7800, lr:0.00011746966, loss:0.016546028, pPAN_max:0.9033184, pPAN_min:0.055826545, elapsed_time:0:37:44.440253

Epoch:13/16: step:7900, lr:0.00011327714, loss:0.01992331, pPAN_max:0.9318548, pPAN_min:0.0001566112, elapsed_time:0:38:13.282801

Epoch:14/16: step:8000, lr:0.00010923427, loss:0.013849643, pPAN_max:0.7794179, pPAN_min:0.0001437366, elapsed_time:0:38:43.820582

Epoch:14/16: step:8100, lr:0.0001053357, loss:0.034268368, pPAN_max:0.6020544, pPAN_min:0.00015118718, elapsed_time:0:39:12.478291

Epoch:14/16: step:8200, lr:0.00010157625, loss:0.02570148, pPAN_max:0.62678796, pPAN_min:0.11278504, elapsed_time:0:39:40.833126

Epoch:14/16: step:8300, lr:9.795097e-05, loss:0.023475654, pPAN_max:0.597253, pPAN_min:0.093438536, elapsed_time:0:40:09.638402

Epoch:14/16: step:8400, lr:9.4455085e-05, loss:0.022240061, pPAN_max:0.9452442, pPAN_min:0.09891018, elapsed_time:0:40:38.561517

Epoch:14/16: step:8500, lr:9.108399e-05, loss:0.02173746, pPAN_max:0.8436637, pPAN_min:0.15052885, elapsed_time:0:41:07.283820

Epoch:15/16: step:8600, lr:8.7833185e-05, loss:0.020509463, pPAN_max:0.8001044, pPAN_min:0.10891825, elapsed_time:0:41:37.685650

Epoch:15/16: step:8700, lr:8.469842e-05, loss:0.02367146, pPAN_max:0.93394345, pPAN_min:0.12622467, elapsed_time:0:42:06.371219

Epoch:15/16: step:8800, lr:8.167553e-05, loss:0.035858825, pPAN_max:0.72340965, pPAN_min:0.12787247, elapsed_time:0:42:35.066789

Epoch:15/16: step:8900, lr:7.876051e-05, loss:0.021381354, pPAN_max:0.87377906, pPAN_min:0.10999796, elapsed_time:0:43:03.682409

Epoch:15/16: step:9000, lr:7.594954e-05, loss:0.011862612, pPAN_max:0.6309402, pPAN_min:0.12415925, elapsed_time:0:43:32.484432

Epoch:15/16: step:9100, lr:7.323888e-05, loss:0.022147715, pPAN_max:0.64918715, pPAN_min:0.00011226535, elapsed_time:0:44:01.170912

Epoch:15/16: step:9200, lr:7.062496e-05, loss:0.017192299, pPAN_max:0.6841998, pPAN_min:0.10966149, elapsed_time:0:44:29.906138

Epoch:16/16: step:9300, lr:6.810435e-05, loss:0.03681405, pPAN_max:0.8268631, pPAN_min:0.13809264, elapsed_time:0:45:00.369081

Epoch:16/16: step:9400, lr:6.567371e-05, loss:0.023438673, pPAN_max:0.622781, pPAN_min:0.110391855, elapsed_time:0:45:29.393636

Epoch:16/16: step:9500, lr:6.3329804e-05, loss:0.027276566, pPAN_max:0.6057258, pPAN_min:0.000113248825, elapsed_time:0:45:58.191830

Epoch:16/16: step:9600, lr:6.106955e-05, loss:0.02526017, pPAN_max:0.94090617, pPAN_min:8.34465e-07, elapsed_time:0:46:26.605711

Epoch:16/16: step:9700, lr:5.8889975e-05, loss:0.014280689, pPAN_max:0.63383305, pPAN_min:0.13382798, elapsed_time:0:46:55.354760

Epoch:16/16: step:9800, lr:5.6788183e-05, loss:0.012765413, pPAN_max:0.73554814, pPAN_min:0.088138044, elapsed_time:0:47:24.163661

Epoch:16/16: step:9824, lr:5.629502e-05, loss:0.02104152, pPAN_max:0.76965654, pPAN_min:0.12661386, elapsed_time:0:47:31.171742

