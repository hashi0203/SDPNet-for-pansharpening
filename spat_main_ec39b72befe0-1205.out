WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
source_pan_data shape: (4914, 264, 264, 1)
gt_data shape: (4914, 264, 264, 4)
data shape: (4914, 264, 264, 5)
Epoches: 20, Batch_size: 10
Train images number 4914, Batches: 491.

Train set has been trimmed 4 samples...

2021-12-05 02:58:43.001551: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-05 02:58:44.705792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38414 MB memory:  -> device: 0, name: A100-PCIE-40GB, pci bus id: 0000:81:00.0, compute capability: 8.0
2021-12-05 02:58:44.707708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38414 MB memory:  -> device: 1, name: A100-PCIE-40GB, pci bus id: 0000:82:00.0, compute capability: 8.0
2021-12-05 02:58:44.709468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38414 MB memory:  -> device: 2, name: A100-PCIE-40GB, pci bus id: 0000:c1:00.0, compute capability: 8.0
2021-12-05 02:58:44.711238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38414 MB memory:  -> device: 3, name: A100-PCIE-40GB, pci bus id: 0000:c2:00.0, compute capability: 8.0
out shape: (10, 264, 264, 1)
2021-12-05 02:58:48.406921: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8301
Epoch:1/20: step:100, lr:0.0019348845, loss:0.03141566, elapsed_time:0:00:20.713794

Epoch:1/20: step:200, lr:0.001871889, loss:0.0030785121, elapsed_time:0:00:33.036269

Epoch:1/20: step:300, lr:0.0018109444, loss:0.0040275715, elapsed_time:0:00:45.338299

Epoch:1/20: step:400, lr:0.0017519841, loss:0.044991676, elapsed_time:0:00:57.432139

Epoch:2/20: step:500, lr:0.0016949435, loss:0.00073444983, elapsed_time:0:01:11.672767

Epoch:2/20: step:600, lr:0.0016397599, loss:0.0017444676, elapsed_time:0:01:23.865744

Epoch:2/20: step:700, lr:0.001586373, loss:0.0026928496, elapsed_time:0:01:36.013271

Epoch:2/20: step:800, lr:0.001534724, loss:0.00021072797, elapsed_time:0:01:48.259764

Epoch:2/20: step:900, lr:0.0014847568, loss:0.004116771, elapsed_time:0:02:00.580983

Epoch:3/20: step:1000, lr:0.0014364165, loss:0.00044347398, elapsed_time:0:02:14.904559

Epoch:3/20: step:1100, lr:0.0013896499, loss:0.0016610915, elapsed_time:0:02:27.134359

Epoch:3/20: step:1200, lr:0.001344406, loss:0.0002833936, elapsed_time:0:02:39.348787

Epoch:3/20: step:1300, lr:0.0013006352, loss:7.030013e-05, elapsed_time:0:02:51.611968

Epoch:3/20: step:1400, lr:0.0012582893, loss:0.00017942328, elapsed_time:0:03:03.846137

Epoch:4/20: step:1500, lr:0.0012173222, loss:0.0329801, elapsed_time:0:03:18.265409

Epoch:4/20: step:1600, lr:0.0011776891, loss:0.00017385402, elapsed_time:0:03:30.609414

Epoch:4/20: step:1700, lr:0.001139346, loss:0.00031333123, elapsed_time:0:03:42.820129

Epoch:4/20: step:1800, lr:0.0011022515, loss:5.7796875e-05, elapsed_time:0:03:55.092856

Epoch:4/20: step:1900, lr:0.0010663647, loss:0.00017182116, elapsed_time:0:04:07.363270

Epoch:5/20: step:2000, lr:0.0010316462, loss:0.0005615655, elapsed_time:0:04:21.837492

Epoch:5/20: step:2100, lr:0.000998058, loss:0.0002766035, elapsed_time:0:04:34.179106

Epoch:5/20: step:2200, lr:0.00096556346, loss:0.0023612478, elapsed_time:0:04:46.551824

Epoch:5/20: step:2300, lr:0.0009341269, loss:0.0005387026, elapsed_time:0:04:58.825449

Epoch:5/20: step:2400, lr:0.00090371387, loss:0.000121822246, elapsed_time:0:05:11.010344

Epoch:6/20: step:2500, lr:0.0008742909, loss:0.00013100525, elapsed_time:0:05:25.468402

Epoch:6/20: step:2600, lr:0.00084582594, loss:0.00039074713, elapsed_time:0:05:37.753754

Epoch:6/20: step:2700, lr:0.0008182877, loss:0.0004548868, elapsed_time:0:05:50.004387

Epoch:6/20: step:2800, lr:0.0007916461, loss:0.00024919695, elapsed_time:0:06:02.301529

Epoch:6/20: step:2900, lr:0.00076587184, loss:0.00017324617, elapsed_time:0:06:14.569764

Epoch:7/20: step:3000, lr:0.0007409367, loss:0.0001652769, elapsed_time:0:06:29.060470

Epoch:7/20: step:3100, lr:0.0007168135, loss:5.1411153e-05, elapsed_time:0:06:41.241486

Epoch:7/20: step:3200, lr:0.00069347565, loss:0.00034572947, elapsed_time:0:06:53.464812

Epoch:7/20: step:3300, lr:0.0006708977, loss:0.00015710466, elapsed_time:0:07:05.825380

Epoch:7/20: step:3400, lr:0.00064905465, loss:9.4284034e-05, elapsed_time:0:07:18.181739

Epoch:8/20: step:3500, lr:0.00062792294, loss:0.0001307957, elapsed_time:0:07:32.711068

Epoch:8/20: step:3600, lr:0.00060747913, loss:0.00043859426, elapsed_time:0:07:44.937490

Epoch:8/20: step:3700, lr:0.0005877009, loss:4.2535463e-05, elapsed_time:0:07:57.272901

Epoch:8/20: step:3800, lr:0.0005685668, loss:3.355592e-05, elapsed_time:0:08:09.554729

Epoch:8/20: step:3900, lr:0.0005500554, loss:0.00011220778, elapsed_time:0:08:21.798579

Epoch:9/20: step:4000, lr:0.0005321469, loss:3.459754e-05, elapsed_time:0:08:36.225460

Epoch:9/20: step:4100, lr:0.0005148214, loss:5.2949734e-05, elapsed_time:0:08:48.504133

Epoch:9/20: step:4200, lr:0.00049805985, loss:0.0003432496, elapsed_time:0:09:00.712261

Epoch:9/20: step:4300, lr:0.00048184418, loss:4.3003558e-05, elapsed_time:0:09:12.957131

Epoch:9/20: step:4400, lr:0.0004661564, loss:2.7159389e-05, elapsed_time:0:09:25.227885

Epoch:10/20: step:4500, lr:0.00045097942, loss:5.9521404e-05, elapsed_time:0:09:39.660930

Epoch:10/20: step:4600, lr:0.00043629648, loss:0.0001805456, elapsed_time:0:09:51.969727

Epoch:10/20: step:4700, lr:0.0004220917, loss:2.9778836e-05, elapsed_time:0:10:04.345614

Epoch:10/20: step:4800, lr:0.00040834935, loss:6.432949e-05, elapsed_time:0:10:16.565654

Epoch:10/20: step:4900, lr:0.00039505432, loss:8.430798e-05, elapsed_time:0:10:28.794364

Epoch:11/20: step:5000, lr:0.00038219223, loss:1.9812758e-05, elapsed_time:0:10:43.203329

Epoch:11/20: step:5100, lr:0.00036974892, loss:2.8404727e-05, elapsed_time:0:10:55.539946

Epoch:11/20: step:5200, lr:0.00035771076, loss:2.7020575e-05, elapsed_time:0:11:07.858617

Epoch:11/20: step:5300, lr:0.00034606442, loss:1.7435625e-05, elapsed_time:0:11:20.105758

Epoch:11/20: step:5400, lr:0.00033479734, loss:2.0539988e-05, elapsed_time:0:11:32.255847

Epoch:12/20: step:5500, lr:0.0003238971, loss:0.00024527567, elapsed_time:0:11:46.575143

Epoch:12/20: step:5600, lr:0.00031335175, loss:3.2425996e-05, elapsed_time:0:11:58.782798

Epoch:12/20: step:5700, lr:0.00030314972, loss:2.3905664e-05, elapsed_time:0:12:11.023316

Epoch:12/20: step:5800, lr:0.00029327985, loss:2.6692689e-05, elapsed_time:0:12:23.347584

Epoch:13/20: step:5900, lr:0.0002837313, loss:1.783689e-05, elapsed_time:0:12:37.825858

Epoch:13/20: step:6000, lr:0.00027449362, loss:0.001192757, elapsed_time:0:12:50.127997

Epoch:13/20: step:6100, lr:0.0002655567, loss:0.0001239701, elapsed_time:0:13:02.312150

Epoch:13/20: step:6200, lr:0.0002569108, loss:2.2933913e-05, elapsed_time:0:13:14.617568

Epoch:13/20: step:6300, lr:0.00024854633, loss:2.5667554e-05, elapsed_time:0:13:26.829666

Epoch:14/20: step:6400, lr:0.00024045425, loss:2.429944e-05, elapsed_time:0:13:41.334633

Epoch:14/20: step:6500, lr:0.00023262555, loss:0.0003389247, elapsed_time:0:13:53.653766

Epoch:14/20: step:6600, lr:0.00022505183, loss:4.0865052e-05, elapsed_time:0:14:06.037397

Epoch:14/20: step:6700, lr:0.00021772462, loss:4.62626e-05, elapsed_time:0:14:18.311058

Epoch:14/20: step:6800, lr:0.00021063598, loss:2.6253338e-05, elapsed_time:0:14:30.641007

Epoch:15/20: step:6900, lr:0.00020377815, loss:1.2393268e-05, elapsed_time:0:14:45.126503

Epoch:15/20: step:7000, lr:0.00019714358, loss:2.1388749e-05, elapsed_time:0:14:57.430631

Epoch:15/20: step:7100, lr:0.000190725, loss:2.4419045e-05, elapsed_time:0:15:09.760899

Epoch:15/20: step:7200, lr:0.00018451545, loss:2.082435e-05, elapsed_time:0:15:22.013730

Epoch:15/20: step:7300, lr:0.00017850802, loss:1.549019e-05, elapsed_time:0:15:34.442239

Epoch:16/20: step:7400, lr:0.0001726962, loss:1.6130172e-05, elapsed_time:0:15:48.946705

Epoch:16/20: step:7500, lr:0.00016707358, loss:1.1311524e-05, elapsed_time:0:16:01.189116

Epoch:16/20: step:7600, lr:0.00016163407, loss:4.490887e-05, elapsed_time:0:16:13.493748

Epoch:16/20: step:7700, lr:0.00015637162, loss:1.4797621e-05, elapsed_time:0:16:25.712688

Epoch:16/20: step:7800, lr:0.00015128049, loss:2.2788488e-05, elapsed_time:0:16:38.004530

Epoch:17/20: step:7900, lr:0.00014635516, loss:9.3699986e-05, elapsed_time:0:16:52.518441

Epoch:17/20: step:8000, lr:0.00014159014, loss:3.1744952e-05, elapsed_time:0:17:04.789576

Epoch:17/20: step:8100, lr:0.00013698026, loss:1.9396048e-05, elapsed_time:0:17:17.173213

Epoch:17/20: step:8200, lr:0.00013252054, loss:1.8809173e-05, elapsed_time:0:17:29.443350

Epoch:17/20: step:8300, lr:0.00012820594, loss:5.413819e-05, elapsed_time:0:17:41.765318

Epoch:18/20: step:8400, lr:0.00012403181, loss:1.2173257e-05, elapsed_time:0:17:56.330494

Epoch:18/20: step:8500, lr:0.00011999363, loss:1.632543e-05, elapsed_time:0:18:08.621274

Epoch:18/20: step:8600, lr:0.00011608689, loss:2.5124029e-05, elapsed_time:0:18:20.866911

Epoch:18/20: step:8700, lr:0.000112307374, loss:1.2969725e-05, elapsed_time:0:18:33.217804

Epoch:18/20: step:8800, lr:0.00010865089, loss:2.5302204e-05, elapsed_time:0:18:45.472456

Epoch:19/20: step:8900, lr:0.00010511347, loss:1.6715636e-05, elapsed_time:0:18:59.965104

Epoch:19/20: step:9000, lr:0.000101691214, loss:1.9273946e-05, elapsed_time:0:19:12.330866

Epoch:19/20: step:9100, lr:9.838038e-05, loss:1.545376e-05, elapsed_time:0:19:24.613139

Epoch:19/20: step:9200, lr:9.517731e-05, loss:2.017144e-05, elapsed_time:0:19:36.864373

Epoch:19/20: step:9300, lr:9.2078575e-05, loss:5.138285e-05, elapsed_time:0:19:49.210387

Epoch:20/20: step:9400, lr:8.90807e-05, loss:1.648915e-05, elapsed_time:0:20:03.660322

Epoch:20/20: step:9500, lr:8.618041e-05, loss:1.1996311e-05, elapsed_time:0:20:15.983964

Epoch:20/20: step:9600, lr:8.337459e-05, loss:2.9017716e-05, elapsed_time:0:20:28.244623

Epoch:20/20: step:9700, lr:8.066008e-05, loss:1.9859712e-05, elapsed_time:0:20:40.504944

Epoch:20/20: step:9800, lr:7.8033954e-05, loss:3.6295125e-05, elapsed_time:0:20:52.841823

Epoch:20/20: step:9820, lr:7.7519086e-05, loss:1.3541714e-05, elapsed_time:0:20:55.297604

