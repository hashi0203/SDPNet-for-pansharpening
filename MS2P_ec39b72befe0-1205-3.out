WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
source_pan_data shape: (1296, 264, 264, 1)
gt_data shape: (1296, 264, 264, 4)
data shape: (1296, 264, 264, 5)
Epoches: 30, Batch_size: 8
Train images number 1296, Batches: 162.

2021-12-05 08:39:23.247062: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-05 08:39:24.941267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38414 MB memory:  -> device: 0, name: A100-PCIE-40GB, pci bus id: 0000:81:00.0, compute capability: 8.0
2021-12-05 08:39:24.943201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38414 MB memory:  -> device: 1, name: A100-PCIE-40GB, pci bus id: 0000:82:00.0, compute capability: 8.0
2021-12-05 08:39:24.945051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38414 MB memory:  -> device: 2, name: A100-PCIE-40GB, pci bus id: 0000:c1:00.0, compute capability: 8.0
2021-12-05 08:39:24.946907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38414 MB memory:  -> device: 3, name: A100-PCIE-40GB, pci bus id: 0000:c2:00.0, compute capability: 8.0
out shape: (8, 264, 264, 1)
MS_converted_PAN shape: (8, 264, 264, 1)
<tf.Variable 'pP_ED/encoder/conv1/kernel:0' shape=(3, 3, 4, 32) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv1/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv2/kernel:0' shape=(3, 3, 32, 64) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv2/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv3/kernel:0' shape=(3, 3, 64, 96) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv3/bias:0' shape=(96,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_1/kernel:0' shape=(3, 3, 96, 64) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_1/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_2/kernel:0' shape=(3, 3, 64, 32) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_2/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_3/kernel:0' shape=(3, 3, 32, 1) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_3/bias:0' shape=(1,) dtype=float32_ref>
2021-12-05 08:39:28.080046: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8301
Epoch:1/30: step:100, lr:0.0017426455, loss:0.07122167, pPAN_max:0.8308689, pPAN_min:0.035212725, elapsed_time:0:00:28.185399

Epoch:2/30: step:200, lr:0.0015184064, loss:0.024068188, pPAN_max:0.8302375, pPAN_min:0.035602033, elapsed_time:0:00:50.884157

Epoch:2/30: step:300, lr:0.001323022, loss:0.01630093, pPAN_max:0.8342258, pPAN_min:0.034204572, elapsed_time:0:01:12.449715

Epoch:3/30: step:400, lr:0.0011527791, loss:0.013402095, pPAN_max:0.8439387, pPAN_min:0.032877415, elapsed_time:0:01:34.579193

Epoch:4/30: step:500, lr:0.0010044425, loss:0.012931958, pPAN_max:0.8404187, pPAN_min:0.03149748, elapsed_time:0:01:57.713100

Epoch:4/30: step:600, lr:0.00087519345, loss:0.012491796, pPAN_max:0.843384, pPAN_min:0.0307464, elapsed_time:0:02:19.540503

Epoch:5/30: step:700, lr:0.00076257583, loss:0.012171462, pPAN_max:0.84680307, pPAN_min:0.030223727, elapsed_time:0:02:41.991179

Epoch:5/30: step:800, lr:0.00066444965, loss:0.012030167, pPAN_max:0.8445695, pPAN_min:0.02958566, elapsed_time:0:03:03.737168

Epoch:6/30: step:900, lr:0.00057895004, loss:0.011886221, pPAN_max:0.84750164, pPAN_min:0.02939263, elapsed_time:0:03:26.168460

Epoch:7/30: step:1000, lr:0.0005044523, loss:0.011751264, pPAN_max:0.8460018, pPAN_min:0.029186398, elapsed_time:0:03:48.638829

Epoch:7/30: step:1100, lr:0.00043954072, loss:0.011692926, pPAN_max:0.8470999, pPAN_min:0.029016405, elapsed_time:0:04:10.483074

Epoch:8/30: step:1200, lr:0.00038298176, loss:0.01173319, pPAN_max:0.8461628, pPAN_min:0.028678626, elapsed_time:0:04:32.862758

Epoch:9/30: step:1300, lr:0.00033370068, loss:0.011609022, pPAN_max:0.8466222, pPAN_min:0.028576016, elapsed_time:0:04:55.156022

Epoch:9/30: step:1400, lr:0.00029076095, loss:0.011405639, pPAN_max:0.8466807, pPAN_min:0.028553963, elapsed_time:0:05:17.037315

Epoch:10/30: step:1500, lr:0.0002533466, loss:0.011418752, pPAN_max:0.84665084, pPAN_min:0.028343886, elapsed_time:0:05:39.423090

Epoch:10/30: step:1600, lr:0.00022074668, loss:0.011359068, pPAN_max:0.84737885, pPAN_min:0.028389066, elapsed_time:0:06:01.338983

Epoch:11/30: step:1700, lr:0.00019234157, loss:0.011356343, pPAN_max:0.84683347, pPAN_min:0.028136224, elapsed_time:0:06:23.660357

Epoch:12/30: step:1800, lr:0.00016759156, loss:0.01129776, pPAN_max:0.84697306, pPAN_min:0.028250515, elapsed_time:0:06:46.052138

Epoch:12/30: step:1900, lr:0.0001460263, loss:0.011289224, pPAN_max:0.8473973, pPAN_min:0.028006434, elapsed_time:0:07:07.790197

Epoch:13/30: step:2000, lr:0.00012723604, loss:0.011318826, pPAN_max:0.8472011, pPAN_min:0.02794519, elapsed_time:0:07:30.191898

Epoch:13/30: step:2100, lr:0.00011086366, loss:0.011178042, pPAN_max:0.84750444, pPAN_min:0.028094351, elapsed_time:0:07:52.084018

Epoch:14/30: step:2200, lr:9.6598014e-05, loss:0.011209357, pPAN_max:0.84719276, pPAN_min:0.027858704, elapsed_time:0:08:14.743974

Epoch:15/30: step:2300, lr:8.416805e-05, loss:0.011149365, pPAN_max:0.8473166, pPAN_min:0.028019667, elapsed_time:0:08:37.169733

Epoch:15/30: step:2400, lr:7.333752e-05, loss:0.011157908, pPAN_max:0.8475909, pPAN_min:0.027975917, elapsed_time:0:08:59.120261

Epoch:16/30: step:2500, lr:6.390065e-05, loss:0.011032455, pPAN_max:0.8472569, pPAN_min:0.028000414, elapsed_time:0:09:21.480376

Epoch:17/30: step:2600, lr:5.567807e-05, loss:0.011074892, pPAN_max:0.8473728, pPAN_min:0.027955472, elapsed_time:0:09:43.873364

Epoch:17/30: step:2700, lr:4.851358e-05, loss:0.01110292, pPAN_max:0.847412, pPAN_min:0.027938515, elapsed_time:0:10:05.812110

Epoch:18/30: step:2800, lr:4.2270967e-05, loss:0.011044078, pPAN_max:0.847337, pPAN_min:0.027904153, elapsed_time:0:10:28.118167

Epoch:18/30: step:2900, lr:3.6831654e-05, loss:0.010982399, pPAN_max:0.84744656, pPAN_min:0.027902156, elapsed_time:0:10:49.877763

Epoch:19/30: step:3000, lr:3.209225e-05, loss:0.011034332, pPAN_max:0.8473169, pPAN_min:0.027885497, elapsed_time:0:11:12.249087

Epoch:20/30: step:3100, lr:2.7962698e-05, loss:0.011099173, pPAN_max:0.84752715, pPAN_min:0.02787581, elapsed_time:0:11:34.665227

Epoch:20/30: step:3200, lr:2.4364546e-05, loss:0.011075042, pPAN_max:0.84739375, pPAN_min:0.02786386, elapsed_time:0:11:56.530389

Epoch:21/30: step:3300, lr:2.1229376e-05, loss:0.011052636, pPAN_max:0.8474067, pPAN_min:0.028420627, elapsed_time:0:12:18.963922

Epoch:21/30: step:3400, lr:1.8497638e-05, loss:0.011043596, pPAN_max:0.84742266, pPAN_min:0.027867347, elapsed_time:0:12:41.070850

Epoch:22/30: step:3500, lr:1.6117414e-05, loss:0.010882534, pPAN_max:0.8474022, pPAN_min:0.027877003, elapsed_time:0:13:03.463965

Epoch:23/30: step:3600, lr:1.4043463e-05, loss:0.011116329, pPAN_max:0.84761447, pPAN_min:0.027864039, elapsed_time:0:13:26.061096

Epoch:23/30: step:3700, lr:1.2236388e-05, loss:0.010946787, pPAN_max:0.8474711, pPAN_min:0.02785191, elapsed_time:0:13:48.124933

Epoch:24/30: step:3800, lr:1.066184e-05, loss:0.01106042, pPAN_max:0.8475616, pPAN_min:0.027613431, elapsed_time:0:14:10.648927

Epoch:25/30: step:3900, lr:9.289908e-06, loss:0.011037028, pPAN_max:0.8475839, pPAN_min:0.027617306, elapsed_time:0:14:33.060403

Epoch:25/30: step:4000, lr:8.094505e-06, loss:0.0109567065, pPAN_max:0.84755725, pPAN_min:0.027611494, elapsed_time:0:14:55.484392

Epoch:26/30: step:4100, lr:7.052926e-06, loss:0.010987667, pPAN_max:0.8474981, pPAN_min:0.027844578, elapsed_time:0:15:18.483922

Epoch:26/30: step:4200, lr:6.145375e-06, loss:0.011094438, pPAN_max:0.8475672, pPAN_min:0.027844667, elapsed_time:0:15:40.994322

Epoch:27/30: step:4300, lr:5.354603e-06, loss:0.010900983, pPAN_max:0.84729856, pPAN_min:0.027867854, elapsed_time:0:16:04.092301

Epoch:28/30: step:4400, lr:4.6655878e-06, loss:0.010995789, pPAN_max:0.84745777, pPAN_min:0.027608216, elapsed_time:0:16:27.106688

Epoch:28/30: step:4500, lr:4.065231e-06, loss:0.010869074, pPAN_max:0.84756005, pPAN_min:0.027823597, elapsed_time:0:16:49.705349

Epoch:29/30: step:4600, lr:3.54213e-06, loss:0.010913001, pPAN_max:0.8474592, pPAN_min:0.027834147, elapsed_time:0:17:12.791895

Epoch:30/30: step:4700, lr:3.0863373e-06, loss:0.0109267235, pPAN_max:0.8475944, pPAN_min:0.027828246, elapsed_time:0:17:36.007151

Epoch:30/30: step:4800, lr:2.6891958e-06, loss:0.0109618995, pPAN_max:0.8474707, pPAN_min:0.027833104, elapsed_time:0:17:58.627665

Epoch:30/30: step:4860, lr:2.4758808e-06, loss:0.010991003, pPAN_max:0.84748566, pPAN_min:0.027611881, elapsed_time:0:18:12.217763

