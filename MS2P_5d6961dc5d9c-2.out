WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
source_pan_data shape: (4914, 264, 264, 1)
gt_data shape: (4914, 264, 264, 4)
data shape: (4914, 264, 264, 5)
Epoches: 8, Batch_size: 8
Train images number 4914, Batches: 614.

Train set has been trimmed 2 samples...

2021-12-03 08:15:36.911224: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-03 08:15:37.455351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78874 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:27:00.0, compute capability: 8.0
out shape: (8, 264, 264, 1)
MS_converted_PAN shape: (8, 264, 264, 1)
<tf.Variable 'pP_ED/encoder/conv1/kernel:0' shape=(3, 3, 4, 32) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv1/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv2/kernel:0' shape=(3, 3, 32, 64) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv2/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv3/kernel:0' shape=(3, 3, 64, 96) dtype=float32_ref>
<tf.Variable 'pP_ED/encoder/conv3/bias:0' shape=(96,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_1/kernel:0' shape=(3, 3, 96, 64) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_1/bias:0' shape=(64,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_2/kernel:0' shape=(3, 3, 64, 32) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_2/bias:0' shape=(32,) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_3/kernel:0' shape=(3, 3, 32, 1) dtype=float32_ref>
<tf.Variable 'pP_ED_1/decoder/conv2_3/bias:0' shape=(1,) dtype=float32_ref>
2021-12-03 08:15:43.666963: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8301
Epoch:1/8: step:100, lr:0.0019286198, loss:0.078204304, pPAN_max:0.88605607, pPAN_min:0.046271622, elapsed_time:0:00:35.270728

Epoch:1/8: step:200, lr:0.0018597872, loss:0.045958273, pPAN_max:0.67462885, pPAN_min:0.09408808, elapsed_time:0:01:01.818139

Epoch:1/8: step:300, lr:0.0017934111, loss:0.04726301, pPAN_max:0.6483947, pPAN_min:0.09784466, elapsed_time:0:01:28.163334

Epoch:1/8: step:400, lr:0.0017294041, loss:0.044917896, pPAN_max:0.7278262, pPAN_min:0.0020268261, elapsed_time:0:01:54.176248

Epoch:1/8: step:500, lr:0.0016676813, loss:0.08142188, pPAN_max:0.83487487, pPAN_min:0.09097311, elapsed_time:0:02:20.936429

WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow/python/training/saver.py:1056: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
Epoch:1/8: step:600, lr:0.0016081616, loss:0.06660232, pPAN_max:0.8867536, pPAN_min:0.10844925, elapsed_time:0:02:47.404043

Epoch:2/8: step:700, lr:0.001550766, loss:0.02836183, pPAN_max:0.71531045, pPAN_min:0.096904546, elapsed_time:0:03:16.505312

Epoch:2/8: step:800, lr:0.0014954191, loss:0.01759478, pPAN_max:0.5971796, pPAN_min:0.14719108, elapsed_time:0:03:42.987048

Epoch:2/8: step:900, lr:0.0014420473, loss:0.032935288, pPAN_max:0.57700896, pPAN_min:0.00023272634, elapsed_time:0:04:09.154794

Epoch:2/8: step:1000, lr:0.0013905803, loss:0.024948118, pPAN_max:0.8470419, pPAN_min:0.14394611, elapsed_time:0:04:35.719161

Epoch:2/8: step:1100, lr:0.0013409505, loss:0.03736484, pPAN_max:0.914249, pPAN_min:0.14992723, elapsed_time:0:05:02.217457

Epoch:2/8: step:1200, lr:0.0012930918, loss:0.02343888, pPAN_max:0.870098, pPAN_min:0.09476021, elapsed_time:0:05:28.495401

Epoch:3/8: step:1300, lr:0.0012469412, loss:0.016796509, pPAN_max:0.46127042, pPAN_min:0.15152869, elapsed_time:0:05:57.729746

Epoch:3/8: step:1400, lr:0.0012024377, loss:0.020392746, pPAN_max:0.6369511, pPAN_min:0.1451242, elapsed_time:0:06:24.253537

Epoch:3/8: step:1500, lr:0.0011595224, loss:0.02398893, pPAN_max:0.8447994, pPAN_min:0.14941937, elapsed_time:0:06:50.693585

Epoch:3/8: step:1600, lr:0.001118139, loss:0.03207942, pPAN_max:0.89288425, pPAN_min:0.10269731, elapsed_time:0:07:17.125862

Epoch:3/8: step:1700, lr:0.0010782324, loss:0.02162818, pPAN_max:0.92477655, pPAN_min:0.11764738, elapsed_time:0:07:43.255721

Epoch:3/8: step:1800, lr:0.0010397503, loss:0.018726338, pPAN_max:0.6855898, pPAN_min:8.368492e-05, elapsed_time:0:08:10.022671

Epoch:4/8: step:1900, lr:0.0010026414, loss:0.024557011, pPAN_max:0.81458664, pPAN_min:1.963973e-05, elapsed_time:0:08:38.878607

Epoch:4/8: step:2000, lr:0.000966857, loss:0.033004403, pPAN_max:0.7482773, pPAN_min:0.07523817, elapsed_time:0:09:05.261994

Epoch:4/8: step:2100, lr:0.00093234977, loss:0.02267617, pPAN_max:0.57195866, pPAN_min:0.11470389, elapsed_time:0:09:31.538386

Epoch:4/8: step:2200, lr:0.00089907413, loss:0.02458225, pPAN_max:0.9261695, pPAN_min:0.1336456, elapsed_time:0:09:58.002108

Epoch:4/8: step:2300, lr:0.000866986, loss:0.03481191, pPAN_max:0.574525, pPAN_min:0.09551081, elapsed_time:0:10:24.389225

Epoch:4/8: step:2400, lr:0.00083604315, loss:0.029079989, pPAN_max:0.6228641, pPAN_min:0.00012248755, elapsed_time:0:10:50.632759

Epoch:5/8: step:2500, lr:0.0008062047, loss:0.030961646, pPAN_max:0.9234144, pPAN_min:5.8621168e-05, elapsed_time:0:11:20.155895

Epoch:5/8: step:2600, lr:0.0007774311, loss:0.03952322, pPAN_max:0.90346485, pPAN_min:0.11142343, elapsed_time:0:11:46.408558

Epoch:5/8: step:2700, lr:0.0007496844, loss:0.020316789, pPAN_max:0.60490453, pPAN_min:0.10295671, elapsed_time:0:12:13.240569

Epoch:5/8: step:2800, lr:0.00072292815, loss:0.023900988, pPAN_max:0.8477013, pPAN_min:0.00012460351, elapsed_time:0:12:39.346322

Epoch:5/8: step:2900, lr:0.00069712667, loss:0.014663089, pPAN_max:0.7346065, pPAN_min:0.10597709, elapsed_time:0:13:05.998541

Epoch:5/8: step:3000, lr:0.0006722462, loss:0.014390735, pPAN_max:0.49243116, pPAN_min:6.8455935e-05, elapsed_time:0:13:32.172847

Epoch:6/8: step:3100, lr:0.0006482537, loss:0.027773045, pPAN_max:0.77076864, pPAN_min:5.441904e-05, elapsed_time:0:14:01.454129

Epoch:6/8: step:3200, lr:0.00062511745, loss:0.036194805, pPAN_max:0.5644348, pPAN_min:0.097268075, elapsed_time:0:14:27.916069

Epoch:6/8: step:3300, lr:0.00060280686, loss:0.029891804, pPAN_max:0.588105, pPAN_min:0.105306506, elapsed_time:0:14:54.467522

Epoch:6/8: step:3400, lr:0.0005812926, loss:0.024874477, pPAN_max:0.6347488, pPAN_min:0.0937573, elapsed_time:0:15:21.269089

Epoch:6/8: step:3500, lr:0.00056054624, loss:0.03523577, pPAN_max:0.94108945, pPAN_min:0.14955625, elapsed_time:0:15:47.718472

Epoch:6/8: step:3600, lr:0.00054054026, loss:0.03801599, pPAN_max:0.82509863, pPAN_min:0.07640478, elapsed_time:0:16:14.163289

Epoch:7/8: step:3700, lr:0.0005212483, loss:0.014877427, pPAN_max:0.5798877, pPAN_min:0.15027198, elapsed_time:0:16:43.122490

Epoch:7/8: step:3800, lr:0.00050264486, loss:0.027526729, pPAN_max:0.79679245, pPAN_min:5.6892633e-05, elapsed_time:0:17:09.575107

Epoch:7/8: step:3900, lr:0.0004847054, loss:0.027872354, pPAN_max:0.8862527, pPAN_min:0.097207576, elapsed_time:0:17:36.004903

Epoch:7/8: step:4000, lr:0.00046740618, loss:0.018546186, pPAN_max:0.9357815, pPAN_min:0.12170005, elapsed_time:0:18:02.670311

Epoch:7/8: step:4100, lr:0.00045072442, loss:0.028778786, pPAN_max:0.8841159, pPAN_min:7.7843666e-05, elapsed_time:0:18:28.787917

Epoch:7/8: step:4200, lr:0.000434638, loss:0.019812463, pPAN_max:0.6997058, pPAN_min:0.11552504, elapsed_time:0:18:55.337246

Epoch:8/8: step:4300, lr:0.0004191257, loss:0.024312396, pPAN_max:0.65055573, pPAN_min:7.05421e-05, elapsed_time:0:19:24.343001

Epoch:8/8: step:4400, lr:0.00040416713, loss:0.01645099, pPAN_max:0.81667984, pPAN_min:0.111206084, elapsed_time:0:19:50.940742

Epoch:8/8: step:4500, lr:0.00038974232, loss:0.024566209, pPAN_max:0.95784986, pPAN_min:4.5895576e-06, elapsed_time:0:20:17.301066

Epoch:8/8: step:4600, lr:0.00037583234, loss:0.019930623, pPAN_max:0.9508743, pPAN_min:0.11535719, elapsed_time:0:20:43.792477

Epoch:8/8: step:4700, lr:0.00036241888, loss:0.029465608, pPAN_max:0.7978512, pPAN_min:0.10888958, elapsed_time:0:21:10.254244

Epoch:8/8: step:4800, lr:0.00034948406, loss:0.017530281, pPAN_max:0.6245234, pPAN_min:0.100349784, elapsed_time:0:21:36.882769

Epoch:8/8: step:4900, lr:0.00033701095, loss:0.021412782, pPAN_max:0.83909273, pPAN_min:0.12337932, elapsed_time:0:22:03.546628

Epoch:8/8: step:4912, lr:0.0003355444, loss:0.024362179, pPAN_max:0.88183856, pPAN_min:0.12825137, elapsed_time:0:22:06.733899

